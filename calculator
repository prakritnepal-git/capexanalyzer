<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capex cash flow analyzer</title>

    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM (Loaded from CDN) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for compiling JSX in the browser -->
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Recharts & Dependencies for charts -->
    <script crossorigin src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <script crossorigin src="https://unpkg.com/recharts@2.12.0/umd/Recharts.js"></script>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">
    
    <!-- This is where the React app will be rendered -->
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, BarChart, Bar } = window.Recharts;

        // --- Icon Components (Replacing Lucide-React for pure HTML support) ---
        const InfoIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>;
        const CalculatorIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-blue-600"><rect width="16" height="20" x="4" y="2" rx="2"></rect><line x1="8" x2="16" y1="6" y2="6"></line><line x1="16" x2="16" y1="14" y2="18"></line><path d="M16 10h.01"></path><path d="M12 10h.01"></path><path d="M8 10h.01"></path><path d="M12 14h.01"></path><path d="M8 14h.01"></path><path d="M12 18h.01"></path><path d="M8 18h.01"></path></svg>;
        const DollarSignIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" x2="12" y1="2" y2="22"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>;
        const PercentIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="19" x2="5" y1="5" y2="19"></line><circle cx="6.5" cy="6.5" r="2.5"></circle><circle cx="17.5" cy="17.5" r="2.5"></circle></svg>;
        const CalendarIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect><line x1="16" x2="16" y1="2" y2="6"></line><line x1="8" x2="8" y1="2" y2="6"></line><line x1="3" x2="21" y1="10" y2="10"></line></svg>;
        const TrendingUpIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>;

        const formatCurrency = (val) => {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(val);
        };

        const InputField = ({ label, name, value, onChange, icon, step = 1 }) => (
            <div className="group">
                <label className="block text-xs font-medium text-gray-500 mb-1 ml-1">{label}</label>
                <div className="relative">
                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400 group-focus-within:text-blue-500">
                    {icon}
                </div>
                <input
                    type="number"
                    name={name}
                    value={value}
                    onChange={onChange}
                    step={step}
                    className="block w-full pl-10 pr-3 py-2 text-sm border-2 border-gray-200 rounded-lg focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors bg-gray-50 focus:bg-white"
                />
                </div>
            </div>
        );

        const ResultCard = ({ title, npv, total, isBest, color }) => {
            const colorClasses = {
                blue: 'bg-blue-50 text-blue-900 border-blue-200',
                indigo: 'bg-indigo-50 text-indigo-900 border-indigo-200',
                emerald: 'bg-emerald-50 text-emerald-900 border-emerald-200',
            };

            const ringClass = isBest ? 'ring-2 ring-offset-2 ring-green-500 border-transparent shadow-md' : '';

            return (
                <div className={`p-5 rounded-xl border-2 ${colorClasses[color]} ${ringClass} transition-all`}>
                    <h3 className="font-semibold text-sm opacity-80 mb-4">{title}</h3>
                    <div className="space-y-3">
                        <div>
                            <p className="text-xs text-gray-500 uppercase tracking-wide">NPV (Discounted)</p>
                            <p className="text-xl font-bold tracking-tight">{formatCurrency(npv)}</p>
                        </div>
                        <div>
                            <p className="text-xs text-gray-500 uppercase tracking-wide">Total Cash Flow</p>
                            <p className="text-lg font-medium opacity-90">{formatCurrency(total)}</p>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('summary');
            const [inputs, setInputs] = useState({
                capex: 15000000,
                depreciationYears: 5,
                leaseTerm: 5,
                interestRate: 9.0,
                wacc: 9.0,
                taxRate: 25.0,
                residualValuePct: 10.0,
                leaseResidualUpliftPct: 75.0, // Default changed to 75%
            });

            const [results, setResults] = useState(null);

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setInputs((prev) => ({
                    ...prev,
                    [name]: parseFloat(value) || 0,
                }));
            };

            useEffect(() => {
                calculateScenarios();
            }, [inputs]);

            const calculateScenarios = () => {
                const { capex, depreciationYears, leaseTerm, interestRate, wacc, taxRate, residualValuePct, leaseResidualUpliftPct } = inputs;
                
                const rInterest = interestRate / 100;
                const rWacc = wacc / 100;
                const rTax = taxRate / 100;
                const rResidual = residualValuePct / 100;

                const residualAmount = capex * rResidual;
                const taxOnResidual = residualAmount * rTax;
                const annualDepreciation = capex / depreciationYears;
                
                const maxYears = Math.max(depreciationYears, leaseTerm);
                // Generating strictly years 1 to N (No Year 0)
                const years = Array.from({ length: maxYears }, (_, i) => i + 1);

                // --- 1. Upfront Cash Scenario ---
                const cashFlows_Cash = years.map(year => {
                    let flow = 0;
                    let capexFlow = 0;
                    let deprShield = 0;
                    let grossRes = 0;
                    let resTax = 0;

                    // Apply Capex fully in Year 1
                    // Apply ALL depreciation tax shield in Year 1 per request
                    if (year === 1) {
                        capexFlow = -capex;
                        deprShield = capex * rTax; 
                        flow += capexFlow + deprShield;
                    }

                    // Recover residual value at the end
                    if (year === maxYears) {
                        grossRes = residualAmount;
                        resTax = -taxOnResidual; // Outflow for taxes
                        flow += grossRes + resTax;
                    }

                    // Discounting starts from Year 2 (Year 1 discounting factor is 0)
                    const discountFactor = Math.pow(1 + rWacc, year - 1);

                    return { 
                        year, 
                        flow, 
                        discounted: flow / discountFactor,
                        details: { capexFlow, deprShield, grossRes, resTax }
                    };
                });

                // --- 2. Debt Financed Scenario ---
                const cashFlows_Debt = years.map(year => {
                    let principal = 0, interest = 0, interestTaxShield = 0, deprTaxShield = 0, grossRes = 0, resTax = 0;
                    let netFlow = 0;

                    if (year <= leaseTerm) {
                        principal = capex / leaseTerm;
                        const beginningBalance = capex - (principal * (year - 1));
                        interest = beginningBalance * rInterest;
                    }
                    
                    // Tax shield based strictly on Interest
                    interestTaxShield = interest * rTax;
                    
                    // Full depreciation tax shield realized in Year 1 because you own the asset
                    if (year === 1) {
                        deprTaxShield = capex * rTax;
                    }

                    const totalTaxShield = interestTaxShield + deprTaxShield;
                    
                    netFlow = -principal - interest + totalTaxShield;

                    if (year === maxYears) {
                        grossRes = residualAmount;
                        resTax = -taxOnResidual; // Outflow for taxes
                        netFlow += grossRes + resTax;
                    }

                    const discountFactor = Math.pow(1 + rWacc, year - 1);

                    return { 
                        year, 
                        flow: netFlow, 
                        discounted: netFlow / discountFactor,
                        details: { principal: -principal, interest: -interest, interestTaxShield, deprTaxShield, grossRes, resTax }
                    };
                });

                // --- 3. Lease Scenario ---
                const pmt = (capex * rInterest) / (1 - Math.pow(1 + rInterest, -leaseTerm));
                
                // Lease specific residual value logic based on user formula
                // % uplift on residual x residual value % x capex
                const rUplift = leaseResidualUpliftPct / 100;
                const totalLeaseResidualBenefit = rUplift * rResidual * capex;
                const annualResidualCredit = totalLeaseResidualBenefit / leaseTerm;

                const cashFlows_Lease = years.map(year => {
                    let leasePmt = 0, taxShield = 0, residualCredit = 0;
                    let netFlow = 0;

                    if (year <= leaseTerm) {
                        leasePmt = -pmt;
                        taxShield = pmt * rTax; // Equivalent to deducting the after-tax portion
                        residualCredit = annualResidualCredit;
                        netFlow = leasePmt + taxShield + residualCredit;
                    }

                    const discountFactor = Math.pow(1 + rWacc, year - 1);

                    return { 
                        year, 
                        flow: netFlow, 
                        discounted: netFlow / discountFactor,
                        details: { leasePmt, taxShield, residualCredit }
                    };
                });

                // --- Aggregates ---
                const sumFlows = (arr) => arr.reduce((acc, curr) => acc + curr.flow, 0);
                const sumDiscounted = (arr) => arr.reduce((acc, curr) => acc + curr.discounted, 0);

                // --- Cumulative Chart Data ---
                let cumCash = 0, cumDebt = 0, cumLease = 0;
                const cumChartData = years.map((y, index) => {
                    cumCash += cashFlows_Cash[index].flow;
                    cumDebt += cashFlows_Debt[index].flow;
                    cumLease += cashFlows_Lease[index].flow;
                    return { year: `Year ${y}`, Cash: cumCash, Debt: cumDebt, Lease: cumLease };
                });

                setResults({
                    years,
                    cash: { flows: cashFlows_Cash, total: sumFlows(cashFlows_Cash), npv: sumDiscounted(cashFlows_Cash) },
                    debt: { flows: cashFlows_Debt, total: sumFlows(cashFlows_Debt), npv: sumDiscounted(cashFlows_Debt) },
                    lease: { flows: cashFlows_Lease, total: sumFlows(cashFlows_Lease), npv: sumDiscounted(cashFlows_Lease), annualPayment: pmt },
                    chartData: years.map((y, index) => ({
                        year: `Year ${y}`,
                        Cash: cashFlows_Cash[index].flow,
                        Debt: cashFlows_Debt[index].flow,
                        Lease: cashFlows_Lease[index].flow,
                    })),
                    cumChartData
                });
            };

            if (!results) return <div className="p-10 text-center text-gray-500">Loading calculator...</div>;

            return (
                <div className="min-h-screen p-6">
                    <div className="max-w-7xl mx-auto space-y-6">
                        
                        {/* Header */}
                        <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col md:flex-row justify-between items-start md:items-center">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-900">Capex cash flow analyzer</h1>
                                <p className="text-gray-500 text-sm mt-1">Financial comparison based on NPV and Total Cash Flow (Starting Year 1)</p>
                            </div>
                            <div className="mt-4 md:mt-0 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium flex items-center gap-2">
                                <InfoIcon />
                                NPV Discount Rate: {inputs.wacc}%
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                            
                            {/* Inputs Panel */}
                            <div className="lg:col-span-4 space-y-6">
                                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                    <h2 className="text-lg font-semibold mb-4 flex items-center gap-2">
                                        <CalculatorIcon /> 
                                        Input Parameters
                                    </h2>
                                    
                                    <div className="space-y-4">
                                        <InputField label="Total Capex Spend" name="capex" value={inputs.capex} onChange={handleInputChange} icon={<DollarSignIcon/>} step={1000} />
                                        
                                        <div className="grid grid-cols-2 gap-4">
                                            <InputField label="Depreciation (Yrs)" name="depreciationYears" value={inputs.depreciationYears} onChange={handleInputChange} icon={<CalendarIcon/>} />
                                            <InputField label="Lease Term (Yrs)" name="leaseTerm" value={inputs.leaseTerm} onChange={handleInputChange} icon={<CalendarIcon/>} />
                                        </div>

                                        <div className="grid grid-cols-2 gap-4">
                                            <InputField label="Interest Rate (%)" name="interestRate" value={inputs.interestRate} onChange={handleInputChange} icon={<PercentIcon/>} step={0.1} />
                                            <InputField label="WACC / Discount (%)" name="wacc" value={inputs.wacc} onChange={handleInputChange} icon={<PercentIcon/>} step={0.1} />
                                        </div>

                                        <div className="grid grid-cols-2 gap-4">
                                            <InputField label="Tax Rate (%)" name="taxRate" value={inputs.taxRate} onChange={handleInputChange} icon={<PercentIcon/>} />
                                            <InputField label="Residual Value (%)" name="residualValuePct" value={inputs.residualValuePct} onChange={handleInputChange} icon={<PercentIcon/>} />
                                        </div>

                                        <div className="pt-2 border-t border-gray-100">
                                            <InputField label="% Uplift on Residual" name="leaseResidualUpliftPct" value={inputs.leaseResidualUpliftPct} onChange={handleInputChange} icon={<TrendingUpIcon/>} />
                                            <p className="text-[10px] text-gray-400 mt-1 leading-tight">Because of the residual value, the customer benefits from that with a certain percent. This amount is spread evenly across the lease term.</p>
                                        </div>
                                    </div>
                                </div>

                                {/* Assumptions Note */}
                                <div className="bg-blue-50 p-4 rounded-xl text-xs text-blue-800 border border-blue-100">
                                    <p className="font-semibold mb-1">Model Assumptions:</p>
                                    <ul className="list-disc pl-4 space-y-1">
                                        <li>All cash flows start strictly in Year 1.</li>
                                        <li>Discounting starts in Year 2 (Year 1 cash flows are undiscounted).</li>
                                        <li>Upfront Cash: Full depreciation tax shield realized entirely in Year 1.</li>
                                        <li>Debt: Linear principal + Declining interest. Full depreciation tax shield in Year 1 PLUS ongoing interest tax shields.</li>
                                        <li>Lease: Calculated on full Capex, with linear credit for residual value (Tax Adjusted).</li>
                                    </ul>
                                </div>
                            </div>

                            {/* Results Panel */}
                            <div className="lg:col-span-8 space-y-6">
                                
                                {/* Top Level Cards */}
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <ResultCard title="Upfront Cash" npv={results.cash.npv} total={results.cash.total} isBest={results.cash.npv > results.debt.npv && results.cash.npv > results.lease.npv} color="blue" />
                                    <ResultCard title="Debt Financed" npv={results.debt.npv} total={results.debt.total} isBest={results.debt.npv > results.cash.npv && results.debt.npv > results.lease.npv} color="indigo" />
                                    <ResultCard title="Lease" npv={results.lease.npv} total={results.lease.total} isBest={results.lease.npv > results.cash.npv && results.lease.npv > results.debt.npv} color="emerald" />
                                </div>

                                {/* Tab Navigation */}
                                <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div className="flex border-b border-gray-100">
                                        <button 
                                            className={`flex-1 py-4 text-sm font-medium transition-colors ${activeTab === 'summary' ? 'bg-blue-50 text-blue-700 border-b-2 border-blue-600' : 'text-gray-500 hover:bg-gray-50'}`}
                                            onClick={() => setActiveTab('summary')}
                                        >
                                            Summary & Charts
                                        </button>
                                        <button 
                                            className={`flex-1 py-4 text-sm font-medium transition-colors ${activeTab === 'details' ? 'bg-blue-50 text-blue-700 border-b-2 border-blue-600' : 'text-gray-500 hover:bg-gray-50'}`}
                                            onClick={() => setActiveTab('details')}
                                        >
                                            Detailed Calculations
                                        </button>
                                    </div>

                                    <div className="p-6">
                                        {activeTab === 'summary' ? (
                                            <div className="space-y-8">
                                                <div>
                                                    <h3 className="text-lg font-semibold mb-6">Cumulative Cash Flow</h3>
                                                    <div className="h-80 w-full">
                                                        <ResponsiveContainer width="100%" height="100%">
                                                            <LineChart data={results.cumChartData} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>
                                                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f0f0f0" />
                                                                <XAxis dataKey="year" stroke="#9ca3af" fontSize={12} tickLine={false} axisLine={false} />
                                                                <YAxis stroke="#9ca3af" fontSize={12} tickFormatter={(val) => `$${(val/1000000).toFixed(1)}M`} tickLine={false} axisLine={false} />
                                                                <Tooltip formatter={(value) => formatCurrency(value)} contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)' }} />
                                                                <Legend />
                                                                <Line type="monotone" dataKey="Cash" stroke="#3b82f6" strokeWidth={3} dot={{r: 4}} />
                                                                <Line type="monotone" dataKey="Debt" stroke="#6366f1" strokeWidth={3} dot={{r: 4}} />
                                                                <Line type="monotone" dataKey="Lease" stroke="#10b981" strokeWidth={3} dot={{r: 4}} />
                                                            </LineChart>
                                                        </ResponsiveContainer>
                                                    </div>
                                                </div>

                                                <div>
                                                    <h3 className="text-lg font-semibold mb-6">Annual Net Cash Flow</h3>
                                                    <div className="h-64 w-full">
                                                        <ResponsiveContainer width="100%" height="100%">
                                                            <BarChart data={results.chartData} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>
                                                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f0f0f0" />
                                                                <XAxis dataKey="year" stroke="#9ca3af" fontSize={12} tickLine={false} axisLine={false} />
                                                                <YAxis stroke="#9ca3af" fontSize={12} tickFormatter={(val) => `$${(val/1000000).toFixed(1)}M`} tickLine={false} axisLine={false} />
                                                                <Tooltip formatter={(value) => formatCurrency(value)} cursor={{fill: '#f9fafb'}} contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)' }} />
                                                                <Legend />
                                                                <Bar dataKey="Cash" fill="#93c5fd" radius={[4, 4, 0, 0]} />
                                                                <Bar dataKey="Debt" fill="#a5b4fc" radius={[4, 4, 0, 0]} />
                                                                <Bar dataKey="Lease" fill="#6ee7b7" radius={[4, 4, 0, 0]} />
                                                            </BarChart>
                                                        </ResponsiveContainer>
                                                    </div>
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="space-y-10">
                                                {/* Upfront Cash Table */}
                                                <div>
                                                    <h3 className="text-md font-bold text-blue-900 mb-3">Upfront Cash - Details</h3>
                                                    <div className="overflow-x-auto rounded-lg border border-gray-200">
                                                        <table className="w-full text-sm text-right">
                                                            <thead className="bg-gray-50 text-gray-600 text-xs uppercase font-semibold">
                                                                <tr>
                                                                    <th className="px-4 py-3 text-left">Year</th>
                                                                    <th className="px-4 py-3">Capex Outflow</th>
                                                                    <th className="px-4 py-3">Depr Tax Shield</th>
                                                                    <th className="px-4 py-3">Gross Residual</th>
                                                                    <th className="px-4 py-3">Tax on Residual</th>
                                                                    <th className="px-4 py-3 text-black">Net Cash Flow</th>
                                                                    <th className="px-4 py-3 text-blue-700">Discounted</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody className="divide-y divide-gray-200 bg-white">
                                                                {results.cash.flows.map(f => (
                                                                    <tr key={f.year} className="hover:bg-gray-50">
                                                                        <td className="px-4 py-3 text-left font-medium">Year {f.year}</td>
                                                                        <td className="px-4 py-3 text-red-600">{f.details.capexFlow !== 0 ? formatCurrency(f.details.capexFlow) : '-'}</td>
                                                                        <td className="px-4 py-3 text-green-600">{f.details.deprShield !== 0 ? formatCurrency(f.details.deprShield) : '-'}</td>
                                                                        <td className="px-4 py-3 text-green-600">{f.details.grossRes !== 0 ? formatCurrency(f.details.grossRes) : '-'}</td>
                                                                        <td className="px-4 py-3 text-red-600">{f.details.resTax !== 0 ? formatCurrency(f.details.resTax) : '-'}</td>
                                                                        <td className="px-4 py-3 font-semibold text-gray-900">{formatCurrency(f.flow)}</td>
                                                                        <td className="px-4 py-3 font-semibold text-blue-700">{formatCurrency(f.discounted)}</td>
                                                                    </tr>
                                                                ))}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>

                                                {/* Debt Table */}
                                                <div>
                                                    <h3 className="text-md font-bold text-indigo-900 mb-3">Debt Financed - Details</h3>
                                                    <div className="overflow-x-auto rounded-lg border border-gray-200">
                                                        <table className="w-full text-sm text-right">
                                                            <thead className="bg-gray-50 text-gray-600 text-xs uppercase font-semibold">
                                                                <tr>
                                                                    <th className="px-4 py-3 text-left">Year</th>
                                                                    <th className="px-4 py-3">Principal</th>
                                                                    <th className="px-4 py-3">Interest</th>
                                                                    <th className="px-4 py-3">Int Tax Shield</th>
                                                                    <th className="px-4 py-3">Depr Tax Shield</th>
                                                                    <th className="px-4 py-3">Gross Residual</th>
                                                                    <th className="px-4 py-3">Tax on Residual</th>
                                                                    <th className="px-4 py-3 text-black">Net Cash Flow</th>
                                                                    <th className="px-4 py-3 text-indigo-700">Discounted</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody className="divide-y divide-gray-200 bg-white">
                                                                {results.debt.flows.map(f => (
                                                                    <tr key={f.year} className="hover:bg-gray-50">
                                                                        <td className="px-4 py-3 text-left font-medium">Year {f.year}</td>
                                                                        <td className="px-4 py-3 text-red-600">{f.details.principal !== 0 ? formatCurrency(f.details.principal) : '-'}</td>
                                                                        <td className="px-4 py-3 text-red-600">{f.details.interest !== 0 ? formatCurrency(f.details.interest) : '-'}</td>
                                                                        <td className="px-4 py-3 text-green-600">{f.details.interestTaxShield !== 0 ? formatCurrency(f.details.interestTaxShield) : '-'}</td>
                                                                        <td className="px-4 py-3 text-green-600">{f.details.deprTaxShield !== 0 ? formatCurrency(f.details.deprTaxShield) : '-'}</td>
                                                                        <td className="px-4 py-3 text-green-600">{f.details.grossRes !== 0 ? formatCurrency(f.details.grossRes) : '-'}</td>
                                                                        <td className="px-4 py-3 text-red-600">{f.details.resTax !== 0 ? formatCurrency(f.details.resTax) : '-'}</td>
                                                                        <td className="px-4 py-3 font-semibold text-gray-900">{formatCurrency(f.flow)}</td>
                                                                        <td className="px-4 py-3 font-semibold text-indigo-700">{formatCurrency(f.discounted)}</td>
                                                                    </tr>
                                                                ))}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>

                                                {/* Lease Table */}
                                                <div>
                                                    <h3 className="text-md font-bold text-emerald-900 mb-3">Lease - Details</h3>
                                                    <div className="overflow-x-auto rounded-lg border border-gray-200">
                                                        <table className="w-full text-sm text-right">
                                                            <thead className="bg-gray-50 text-gray-600 text-xs uppercase font-semibold">
                                                                <tr>
                                                                    <th className="px-4 py-3 text-left">Year</th>
                                                                    <th className="px-4 py-3">Lease Payment</th>
                                                                    <th className="px-4 py-3">Tax Shield</th>
                                                                    <th className="px-4 py-3">Residual Credit</th>
                                                                    <th className="px-4 py-3 text-black">Net Cash Flow</th>
                                                                    <th className="px-4 py-3 text-emerald-700">Discounted</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody className="divide-y divide-gray-200 bg-white">
                                                                {results.lease.flows.map(f => (
                                                                    <tr key={f.year} className="hover:bg-gray-50">
                                                                        <td className="px-4 py-3 text-left font-medium">Year {f.year}</td>
                                                                        <td className="px-4 py-3 text-red-600">{f.details.leasePmt !== 0 ? formatCurrency(f.details.leasePmt) : '-'}</td>
                                                                        <td className="px-4 py-3 text-green-600">{f.details.taxShield !== 0 ? formatCurrency(f.details.taxShield) : '-'}</td>
                                                                        <td className="px-4 py-3 text-green-600">{f.details.residualCredit !== 0 ? formatCurrency(f.details.residualCredit) : '-'}</td>
                                                                        <td className="px-4 py-3 font-semibold text-gray-900">{formatCurrency(f.flow)}</td>
                                                                        <td className="px-4 py-3 font-semibold text-emerald-700">{formatCurrency(f.discounted)}</td>
                                                                    </tr>
                                                                ))}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>

                                            </div>
                                        )}
                                    </div>
                                </div>

                            </div>
                        </div>
                        
                        {/* Footer */}
                        <div className="text-center text-sm text-gray-500 mt-8 pb-4">
                            Reach out to Prakrit if you have questions
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
